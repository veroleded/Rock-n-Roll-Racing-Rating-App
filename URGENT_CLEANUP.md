# üö® –°–†–û–ß–ù–ê–Ø –û–ß–ò–°–¢–ö–ê –î–ò–°–ö–ê - –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ 98%!

## –®–∞–≥ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ - —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–∏:

```bash
# 1. –û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker
docker system df

# 2. –†–∞–∑–º–µ—Ä –≤—Å–µ—Ö Docker –æ–±—Ä–∞–∑–æ–≤
docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}" | sort -k3 -h

# 3. –†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
du -sh /var/lib/docker/containers/*/ 2>/dev/null | sort -h | tail -20

# 4. –†–∞–∑–º–µ—Ä –≤—Å–µ—Ö volumes
docker volume ls -q | xargs -r docker volume inspect 2>/dev/null | grep -E '"Mountpoint"|"Name"' | paste - - | awk '{print $4 " -> " $2}' | sed 's/"//g'

# 5. –¢–æ–ø 10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ —Å–∏—Å—Ç–µ–º–µ
du -h --max-depth=1 / 2>/dev/null | sort -rh | head -10

# 6. –†–∞–∑–º–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Docker
du -sh /var/lib/docker/* 2>/dev/null | sort -h
```

## –®–∞–≥ 2: –ë–ï–ó–û–ü–ê–°–ù–ê–Ø –æ—á–∏—Å—Ç–∫–∞ (–ù–ï —É–¥–∞–ª—è–µ—Ç volumes –±–∞–∑—ã!)

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
cd /path/to/Rock-n-Roll-Racing-Rating-App
docker-compose -f docker-compose.prod.yml down

# 2. –£–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker container prune -f

# 3. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã (–æ—Å–≤–æ–±–æ–¥–∏—Ç –ú–ù–û–ì–û –º–µ—Å—Ç–∞!)
docker image prune -a -f

# 4. –û—á–∏—Å—Ç–∏—Ç—å build cache (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º!)
docker builder prune -a -f

# 5. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–µ—Ç–∏
docker network prune -f

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
docker system df
df -h
```

## –®–∞–≥ 3: –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ Docker (–µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª—å—à–∏–µ)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
du -sh /var/lib/docker/containers/*/

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ (–ù–ï —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏!)
# –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ –æ—á–∏—Å—Ç–∏—Ç –í–°–ï –ª–æ–≥–∏ Docker!
truncate -s 0 /var/lib/docker/containers/*/*-json.log

# –ò–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker logs --tail 0 rnr_racing_app > /dev/null 2>&1 || true
docker logs --tail 0 rnr_racing_db > /dev/null 2>&1 || true
docker logs --tail 0 rnr_racing_nginx > /dev/null 2>&1 || true
```

## –®–∞–≥ 4: –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤
du -sh /var/log/* | sort -h | tail -10

# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
journalctl --vacuum-time=7d  # –û—Å—Ç–∞–≤–∏—Ç—å –ª–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
journalctl --vacuum-size=100M  # –û—Å—Ç–∞–≤–∏—Ç—å –º–∞–∫—Å–∏–º—É–º 100MB –ª–æ–≥–æ–≤
```

## –®–∞–≥ 5: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```bash
cd /path/to/Rock-n-Roll-Racing-Rating-App

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω)
git pull

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –Ω–∞ –ª–æ–≥–∏
docker-compose -f docker-compose.prod.yml up -d --build
```

## –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ
df -h

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker
docker system df

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose -f docker-compose.prod.yml ps
docker-compose -f docker-compose.prod.yml logs --tail=20 app
```

## ‚ö†Ô∏è –í–ê–ñ–ù–û - –ß–¢–û –ù–ï –£–î–ê–õ–Ø–¢–¨:

- ‚ùå –ù–ï —É–¥–∞–ª—è—Ç—å volume `postgres_data` - —ç—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö!
- ‚ùå –ù–ï —É–¥–∞–ª—è—Ç—å volume `next_build_cache` - —ç—Ç–æ –∫—ç—à —Å–±–æ—Ä–∫–∏
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `docker volume prune` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏!

## –ï—Å–ª–∏ –º–µ—Å—Ç–∞ –≤—Å–µ –µ—â–µ –º–∞–ª–æ:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ:
```bash
cd /path/to/Rock-n-Roll-Racing-Rating-App
find . -type f -size +100M -exec ls -lh {} \;
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º):
```bash
docker exec rnr_racing_db psql -U postgres -c "SELECT pg_size_pretty(pg_database_size('your_database_name'));"
```

3. –ï—Å–ª–∏ –±–∞–∑–∞ –±–æ–ª—å—à–∞—è, –º–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (–ü–û–°–õ–ï –†–ï–ó–ï–†–í–ù–û–ô –ö–û–ü–ò–ò!):
```bash
# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è!
docker exec rnr_racing_db pg_dump -U postgres your_database_name > backup_$(date +%Y%m%d).sql

# –ü—Ä–æ—Å–º–æ—Ç—Ä —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ
docker exec rnr_racing_app npm run cleanup-old-data -- --dry-run

# –û—á–∏—Å—Ç–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker exec rnr_racing_app npm run cleanup-old-data
```

